# Vulnerability Assessments
A Vulnerability Assessment aims to identify and categorize risks for security weaknesses related to assets within an environment. It is important to note that there is little to no manual exploitation during a vulnerability assessment. A vulnerability assessment also provides remediation steps to fix the issues.

Risk: something bad that could happen
Threat: something bad that is happening
Vulnerabilities: weaknesses that could lead to a threat

### Asset Management 
When an organization of any kind, in any industry, and of any size needs to plan their cybersecurity strategy, they should start by creating an inventory of their data assets. These assets that need to known and be protected.Asset inventory is a critical component of vulnerability management. An organization needs to understand what assets are in its network to provide the proper protection and set up appropriate defenses. 

These assets could be 
1) All data stored on-premises.
2) All of the data storage that their cloud provider possesses.
3) All data stored within various Software-as-a-Service (SaaS) applications. (online services such as Google Drive, Dropbox, Microsoft Teams, Apple iCloud, Adobe Creative Suite, Microsoft Office 365, Google Docs)
4) All of the applications a company needs to use to conduct their usual operation and business.
5) All of a company's on-premises computer networking devices. (Hubs,switches,etc)

# Assessment Standards
Both penetration tests and vulnerability assessments should comply with specific standards to be accredited and accepted by governments and legal authorities.

### Compliance Standards

1. **PCI DSS (Payment Card Industry Data Security Standard)**  
   - **Focus**: Protects credit card data.  
   - **Key Requirement**: Organizations handling cardholder data must secure it in a segmented environment (CDE) separate from regular systems.  
   - **Example**: An online store like Amazon must secure credit card processing systems from the rest of its network.

2. **HIPAA (Health Insurance Portability and Accountability Act)**  
   - **Focus**: Protects patients' medical data.  
   - **Key Requirement**: Requires risk assessments and vulnerability identification to secure sensitive health information.  
   - **Example**: Hospitals must regularly assess their systems to protect patient records.

3. **FISMA (Federal Information Security Management Act)**  
   - **Focus**: Secures government systems and data.  
   - **Key Requirement**: Mandates a vulnerability management program to maintain system confidentiality, integrity, and availability.  
   - **Example**: A government agency must prove that its systems are regularly checked for security issues.

4. **ISO 27001 (Information Security Standard)**  
   - **Focus**: Global standard for managing information security.  
   - **Key Requirement**: Requires internal and external scans at least quarterly and maintains an Information Security Management System.  
   - **Example**: A tech company performs quarterly security scans to stay ISO 27001 certified.

These standards help protect sensitive data and ensure organizations are meeting security best practices.
### Penetration Testing Standards
Penetration tests should not be performed without any rules or guidelines. The owner of a network must have a signed legal contract with pentesters outlining what they're allowed to do and what they're not allowed to do.

__Penetration Testing Execution Standard (PTES)__ can be applied to all types of tests. These are the sections in the PTES: Pre-engagement Interactions,Intelligence,Gathering,Threat Modeling,Vulnerability Analysis,Exploitation,Post Exploitation,Reporting.

__OSSTMM is the Open Source Security Testing Methodology Manual__, another set of guidelines pentesters can use to ensure they're doing their jobs properly. OSSTMM is divided into five different channels Human Security (human beings are subject to social engineering exploits) ,Physical Security, Wireless Communications (including but not limited to technologies like WiFi and Bluetooth), Telecommunications, Data Networks.

__The NIST (National Institute of Standards and Technology)__ is well known for their NIST Cybersecurity Framework, a system for designing incident response policies and procedures. The phases are Planning, Discovery, Attack, Reporting.

__OWASP__ stands for the Open Web Application Security Project. They're typically the go-to organization for defining testing standards and classifying risks to web applications.

# Common Vulnerability Scoring System (CVSS)

**CVSS** is an industry-standard used to score vulnerabilities, helping prioritize risks based on exploitability and impact. It is often paired with Microsoft's **DREAD** model, which assesses risks using five factors:

- **Damage Potential**
- **Reproducibility**
- **Exploitability**
- **Affected Users**
- **Discoverability**

---

### CVSS Components:

1. **Exploitability Metrics**
   - **Attack Vector**: How the attack is delivered (e.g., network, physical).
   - **Attack Complexity**: How hard it is to exploit the issue.
   - **Privileges Required**: User privileges needed for the exploit.
   - **User Interaction**: Whether user action is needed to exploit.

2. **Impact Metrics**
   - Based on the **CIA Triad**:
     - **Confidentiality**: Protecting sensitive info (e.g., passwords).
     - **Integrity**: Ensuring info remains unaltered

# Common Vulnerabilities and Exposures (CVE)
### Open Vulnerability Assessment Language (OVAL) – Simplified

**OVAL** is an international standard used to assess and report the security status of a system. It helps security teams understand system configurations, vulnerabilities, and issues without needing to exploit them. It's widely used by the U.S. government (DHS, NIST) and security tools like Nessus to automate vulnerability management and ensure systems are compliant with policies.

#### OVAL Process:
- **Identify** system configurations for testing.
- **Evaluate** the system’s current state (e.g., vulnerable, patched).
- **Report** the findings.

#### OVAL Definitions:
- **Vulnerability Definitions**: Check for system vulnerabilities.
- **Compliance Definitions**: Ensure systems follow required policies.
- **Inventory Definitions**: Check if certain software is installed.
- **Patch Definitions**: Verify if a system has the right security patches.

#### OVAL ID Format:
- Example: `oval:org.mitre.oval:obj:1116`

### Common Vulnerabilities and Exposures (CVE) – Simplified

**CVE** is a public catalog of known security issues. Each vulnerability is given a unique **CVE ID**, allowing organizations to track, manage, and fix them. The **CVE program** is managed by the U.S. Department of Homeland Security (DHS) and ensures that vulnerabilities are standardized across different platforms and tools.

#### Stages of Getting a CVE ID:
1. **Identify** if an issue qualifies as a vulnerability.
2. **Contact** the affected product’s vendor.
3. If the vendor is a **CVE Numbering Authority (CNA)**, they can assign a CVE ID.
4. If not, submit a request through the **CVE web form**.
5. After submission, receive a **confirmation email**.
6. If approved, receive the **CVE ID**.
7. The CVE ID becomes **public** after notifying vendors and affected parties.
8. **Announce** the CVE to the public.
9. Provide additional information for the CVE database.

# Vulnerability Scanning Overview

Vulnerability scanning identifies potential weaknesses in network devices (routers, firewalls, switches), servers, workstations, and applications. These automated scans detect known vulnerabilities but require manual validation to confirm real issues versus false positives. While vulnerability scanning is part of penetration testing, it’s not the same; a full pen test includes more than just scans. Scanning tools run static tests (checking for known CVEs) and dynamic tests (testing with benign payloads). Organizations should run both authenticated and unauthenticated scans regularly to catch new vulnerabilities and ensure proper patch management. Popular tools include Nessus, Nexpose, Qualys, and OpenVAS.

# Nessus

__Download__
[Nessus Binary Download](https://www.tenable.com/downloads/nessus?loginAttempted=true)
after that request for free license
__Installing Package__
```
 dpkg -i Nessus-8.15.1-ubuntu910_amd64.deb
```
__Start__

```
sudo systemctl start nessusd.service
```

__Accessing Nessus__
```
 https://localhost:8834      
```
Select Nessus essentials for free version.

### Nessus Scan Overview

- **Starting a Scan**: Click "New Scan" and select a scan type. Templates fall into Discovery, Vulnerabilities, and Compliance categories.

- **Scan Types**:
  - **Host Discovery**: Identifies live hosts/open ports.
  - **Basic Network Scan**: Scans network targets.
  - **Advanced Scan**: Customizable scan options.
  - **Malware Scan, Web Application Tests, CVE-specific, and Compliance Scans**.

- **Discovery Settings**:
  - **Host Discovery**: Option to enable/disable scanning fragile devices like printers.
  - **Port Scanning**: Choose to scan common ports, all ports, or a defined range.
  - **Service Discovery**: Probe all ports to find services and check SSL/TLS services.

- **Assessment Settings**:
  - **Web Application Scanning**: Enable and customize with user agent, URL for RFI testing.
  - **Authentication**: Use provided credentials for authenticated scans or brute-force attack with username/password lists.
  - **User Enumeration**: Techniques like RID Brute Forcing.

- **Advanced Settings**:
  - **Safe Checks**: Enabled by default to avoid negative impact.
  - **Throttle/Stop**: Adjust scan speed and handle unresponsive hosts.
  - **Random Scan Order**: Option to scan targets in random order.

### Nessus Advanced Settings

#### Scan Policies
- Create custom scan policies with specific settings, saved for future use under **Scan Templates**.
- Options include **Basic Network Scan**, **Advanced Scan**, and others.
- Customize settings, add credentials, and specify compliance standards.
- Save and use policies for targeted scans.
  
#### Plugins
- **Nessus Plugins** are written in **NASL** and detect specific vulnerabilities (145,973+ plugins).
- Plugins have severity levels: Critical, High, Medium, Low, Info.
- False positives (e.g., SSL/TLS issues) can be excluded using **Plugin Rules** by specifying Plugin ID and host.
  
#### Credentialed Scanning
- Supports host-based authentication via **SSH, Kerberos**, or **Windows Authentication**.
- Can authenticate databases (Oracle, PostgreSQL, etc.).
- Can perform plaintext authentication (FTP, HTTP, etc.).
  
#### Authentication Verification
- Check Nessus output to confirm successful authentication using the provided credentials.
## Nessus Reports and Exporting Scan Results

### Export Formats:
- **PDF**, **HTML**, **CSV**
  - PDF/HTML for Executive Summary or Custom Report
  - CSV allows custom column selection, useful for tools like Splunk.
  - Nessus and Nessus DB formats for raw scan results.

### Executive Summary Report:
- Lists hosts, number of vulnerabilities per host.
- Shows severity, CVSS score, plugin details (with link to Tenable plugin database).

### Custom Reports:
- Best used alongside a custom vulnerability assessment or penetration test report, not as the final deliverable.

### Export Options:
- **.nessus file**: XML format, includes scan settings and plugin outputs.
- **.db file**: Includes .nessus file, scan's knowledge base (KB), plugin audit trail, and attachments.

### Automation:
- Tools like **nessus-report-downloader** can automate downloading scan results via the Nessus REST API.
```
./nessus_downloader.rb
```

## Scanning Issues and Best Practices

- **Sensitive Networks:** Scans can cause problems on sensitive networks (false positives, no results, or network disruptions).
- **Client Communication:** Always communicate with clients or internal stakeholders before scanning. Exclude sensitive/legacy hosts or scan critical hosts outside business hours.
- **Unexpected Results:** Sometimes scans return odd results. Fine-tune by adjusting scan settings.

### Mitigating Issues

- **Firewall Issues:** Some firewalls may show all ports open or no ports open. To fix this, disable "Ping the remote host" in an Advanced Scan.
- **Rate-Limiting:** Adjust performance options like Max Concurrent Checks Per Host to minimize impact on busy hosts (e.g., web apps).
- **Excluding Legacy Systems:** Avoid scanning legacy systems or printers. Use the **nessusd.rules** file for fine control over scans.
- **Avoid Denial of Service Checks:** Always enable "safe checks" to avoid plugins that might crash services, but it doesn't guarantee zero impact.

### Network Impact

- **Low Bandwidth/Heavy Load:** Vulnerability scans can affect network performance, especially on low bandwidth or congested links.
- **Logging:** Keep detailed logs of scan activity in case of issues or incidents.
```
sudo vnstat -l -i eth0
```
